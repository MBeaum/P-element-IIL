"0","library(ggplot2)"
"0","library(gridExtra)"
"0","theme_set(theme_bw())"
"0",""
"0","datasets <- list()"
"0",""
"0","for (i in 1:5) {"
"0","  file_path <- sprintf(""/Volumes/Data/Projects/invaded_inbred_lines/dna/popTE2/dmel/bgi/replicates/%d.teinsertions"", i)"
"0","  dataset <- read.table(file_path)"
"0","  names(dataset) <- c(""Sample"", ""Chromosome"", ""Position"", ""Strand"", ""TE"", ""Order"", ""FR"", ""Comment"", ""Frequency"")"
"0","  "
"0","  dataset <- subset(dataset, Chromosome %in% c(""X"", ""2L"", ""2R"", ""3L"", ""3R"", ""4""))"
"0","  "
"0","  datasets[[i]] <- dataset"
"0","}"
"0",""
"0","plots <- list()"
"0",""
"0","for (i in 1:5) {"
"0","  dataset <- datasets[[i]]"
"0",""
"0","  plot <- ggplot(dataset, aes(x = Position, y = Frequency, color = Frequency)) +"
"0","    geom_point(size = 0.5) +"
"0","    facet_grid(. ~ Chromosome, scales = ""free_x"", space = ""free_x"") +"
"0","    scale_x_continuous(breaks = c(0, 5000000, 10000000, 15000000, 20000000, 25000000),"
"0","                       labels = c(""0"", ""5m"", ""10m"", ""15m"", ""20m"", ""25m"")) +"
"0","    scale_y_continuous(name = ""population frequency"", limits = c(0, 1),"
"0","                       breaks = seq(0, 1, by = 0.1)) +"
"0","    scale_color_gradient(low = ""blue"", high = ""red"") +"
"0","    theme(legend.position = ""none"", plot.title = element_text(hjust = 0.5, size = 14)) +"
"0","    labs(title = paste(""Replicate"", i))"
"0","  "
"0","  plots[[i]] <- plot"
"0","}"
"0",""
"0","grid <- do.call(grid.arrange, c(plots, ncol = 2))"
